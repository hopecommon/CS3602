{
  "script": "mit-streaming-llm/examples/benchmark_streaming.py",
  "mode": "streaming",
  "model_name_or_path": "EleutherAI/pythia-2.8b",
  "model_type": "gpt_neox",
  "device": "cuda",
  "start_size": 32,
  "recent_size": 2016,
  "prefix_tokens": 20000,
  "prefill_chunk_size": 512,
  "gen_tokens_requested": 17952,
  "gen_tokens_produced": 17952,
  "data_json": "data/pg19/long_context_50000.json",
  "data_text_key": "text",
  "data_take": "head",
  "recompute_window_tokens": 2048,
  "recompute_keep_start": false,
  "enable_pos_shift": false,
  "metrics": {
    "prefill_sec": 1.7888874881900847,
    "decode_sec": 295.6112843621522,
    "decode_tokens_per_second": 60.72839891323998,
    "tpot_ms": 16.466760492544132,
    "peak_memory_mb": 7890.39404296875,
    "kv_len_after_prefill": 2048,
    "kv_len_after_decode": 2048
  },
  "cuda_peak": {
    "prefill": [
      {
        "device": 0,
        "max_allocated_mb": 7661.8193359375,
        "max_reserved_mb": 8178.0
      },
      {
        "device": 1,
        "max_allocated_mb": 0.0,
        "max_reserved_mb": 0.0
      },
      {
        "device": 2,
        "max_allocated_mb": 0.0,
        "max_reserved_mb": 0.0
      },
      {
        "device": 3,
        "max_allocated_mb": 0.0,
        "max_reserved_mb": 0.0
      },
      {
        "device": 4,
        "max_allocated_mb": 0.0,
        "max_reserved_mb": 0.0
      },
      {
        "device": 5,
        "max_allocated_mb": 0.0,
        "max_reserved_mb": 0.0
      },
      {
        "device": 6,
        "max_allocated_mb": 0.0,
        "max_reserved_mb": 0.0
      },
      {
        "device": 7,
        "max_allocated_mb": 0.0,
        "max_reserved_mb": 0.0
      }
    ],
    "decode": [
      {
        "device": 0,
        "max_allocated_mb": 7890.39404296875,
        "max_reserved_mb": 9260.0
      },
      {
        "device": 1,
        "max_allocated_mb": 0.0,
        "max_reserved_mb": 0.0
      },
      {
        "device": 2,
        "max_allocated_mb": 0.0,
        "max_reserved_mb": 0.0
      },
      {
        "device": 3,
        "max_allocated_mb": 0.0,
        "max_reserved_mb": 0.0
      },
      {
        "device": 4,
        "max_allocated_mb": 0.0,
        "max_reserved_mb": 0.0
      },
      {
        "device": 5,
        "max_allocated_mb": 0.0,
        "max_reserved_mb": 0.0
      },
      {
        "device": 6,
        "max_allocated_mb": 0.0,
        "max_reserved_mb": 0.0
      },
      {
        "device": 7,
        "max_allocated_mb": 0.0,
        "max_reserved_mb": 0.0
      }
    ]
  }
}